c("mean"=mean(sample), "sd"=sd(sample), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n), mean(sample2))
n <- 10000
sample <- c()
sample2 <- c()
for (i in 1:n){
sample <- c(sample, mean(rpois(1000, lam)))
sample2 <- c(sample, sd(rpois(1000, lam)))
}
c("mean"=mean(sample), "sd"=sd(sample), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n), mean(sample2)/n)
n <- 10000
sample <- c()
sample2 <- 0
for (i in 1:n){
sample <- c(sample, mean(rpois(1000, lam)))
sample2 <- sample2 + sd(rpois(1000, lam))
}
c("mean"=mean(sample), "sd"=sd(sample), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n), sample2/n)
n <- 10000
sample <- c()
sample2 <- 0
for (i in 1:n){
sample <- c(sample, mean(rpois(1000, lam)))
sample2 <- sample2 + var(rpois(1000, lam))
}
c("mean"=mean(sample), "sd"=sd(sample), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n), sqrt(sample2/n))
n <- 10000
sample <- c()
sample2 <- 0
for (i in 1:n){
sample <- c(sample, mean(rpois(1000, lam)))
sample2 <- sample2 + var(rpois(1000, lam))
}
c("mean"=mean(sample), "sd"=sd(sample), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n), sqrt(sample2/n^2))
n  <- 10000
mu <- 0
s2 <- 0
for (i in 1:n){
mu <- mu + mean(rpois(1000, lam)))
n  <- 10000
mu <- 0
s2 <- 0
for (i in 1:n){
mu <- mu + mean(rpois(1000, lam))
s2 <- s2 + var(rpois(1000, lam))
}
c("mean"=mu/n, "sd"=s2/(n^2), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- 0
s2 <- 0
for (i in 1:n){
mu <- mu + mean(rpois(1000, lam))
s2 <- s2 + var(rpois(1000, lam))
}
c("mean"=mu/n, "sd"=sqrt(s2/(n^2)), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
lam = 0.5
Y = rpois(1000, lam)
c("mean"=mean(Y), "sd"=sd(Y))
lam = 0.5
Y = rpois(1000, lam)
c("mean"=mean(Y), "sd"=sd(Y))
data(Students)
read.csv("Students.csv")
read.csv("Students.csv", sep = " ")
read.table("Students.txt", sep=" ")
read.table("Students.txt", sep=" ")
read.table("Students.txt", header=T)
Students <- read.table("Students.txt", header=T)
Students
Students.head()
Students.head
head(Students)
tv <- Students$tv
sample_mean <- mean(tv)
s           <- sd(tv)
z <- sample_mean + c(-1, 1)*qnorm(0.025)*s/sqrt(n)
tv <- Students$tv
sample_mean <- mean(tv)
s           <- sd(tv)
z <- sample_mean + c(-1, 1)*qnorm(0.025)*s/sqrt(n)
z
tv <- Students$tv
sample_mean <- mean(tv)
s           <- sd(tv)
z <- sample_mean + c(1, -1)*qnorm(0.025)*s/sqrt(n)
z
mean(tv[Students$gender == 0])
mean(tv[Students$gender == 1])
Students$gender
mean(tv[Students$gender == 0])
mean(tv[Students$gender == 1])
lenght(tv)
length(tv)
hist(tv)
mean(tv[Students$gender == 0])
mean(tv[Students$gender == 1])
qqnorm(tv)
qqline()
qqnorm(tv)
qqnorm(tv)
qqline()
qqnorm(tv)
qqline(tv)
tv <- Students$tv
sample_mean <- mean(tv)
s           <- sd(tv)
n           <- length(tv)
z <- sample_mean + c(1, -1)*qt(0.025, df=n-1, lower.tail = FALSE)*s/sqrt(n)
z
tv <- Students$tv
sample_mean <- mean(tv)
s           <- sd(tv)
n           <- length(tv)
z <- sample_mean + c(-1, 1)*qt(0.025, df=n-1, lower.tail = FALSE)*s/sqrt(n)
z
pt(t, df=n-1, lower.tail = FALSE)
tv <- Students$tv
sample_mean <- mean(tv)
s           <- sd(tv)
n           <- length(tv)
mu0         <- 4
t <- (sample_mean - mu0) / (s / sqrt(n))
pt(t, df=n-1, lower.tail = FALSE)
z <- sample_mean + c(-1, 1)*qt(0.025, df=n-1, lower.tail = FALSE)*s/sqrt(n)
z
600000/5
?seq
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 + rnorm(0, 2)
plot(x, y)
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 2)
plot(x, y)
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 + x*rnorm(1, 0, 5)
plot(x, y)
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 rnorm(1, 0, 5)
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
rnorm(1, 0, 5)
x <- seq(0, 10, length.out = 100)
y <- 2.5*x + 3 + 2.5*rnorm(1, 0, 5)
plot(x, y)
y
y <- 2.5*x + 3 + rnorm(1, 0, 5)
y
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x
y
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
y <- 2.5*x + 3 +
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
rnorm(1, 0, 5)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x <- 1:10:2
x <- 1:2:10
y <- 2.5*x + 3 + rnorm(1, 0, 5)
plot(x, y)
x
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 5)
plot(x, y)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
abline(predict(fit, intervall="c"))
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
curve(predict(fit, intervall="c"))
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
lines(predict(fit, intervall="c"))
predict(fit)
predict(fit, interval = "c")
means$lwr
means <- predict(fit, interval = "c")
means$lwr
means[,1]
means[,2]
means[,3]
means
lines(fit[, 1], fit[, 2])
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
means <- predict(fit, interval = "c")
lines(means[, 1], means[, 2], col="purple", type="s")
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
means <- predict(fit, interval = "c")
lines(means[, 1], means[, 2], col="purple")
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple")
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple")
lines(x, means[, 3], col="purple")
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple", type="s")
lines(x, means[, 3], col="purple")
lines(x, means[, 2], col="purple", lty=2)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red")
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple", lty=2)
lines(x, means[, 3], col="purple")
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red", lwd = 2)
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple", lty=2, lwd = 2)
lines(x, means[, 3], col="purple", lty=2, lwd = 2)
news <- predict(fit, interval = "p")
lines(x, news[, 2], col="purple", lty=2, lwd = 2)
lines(x, news[, 3], col="purple", lty=2, lwd = 2)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
abline(fit, col="red", lwd = 2)
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple", lty=2, lwd = 2)
lines(x, means[, 3], col="purple", lty=2, lwd = 2)
news <- predict(fit, interval = "p")
lines(x, news[, 2], col="blue", lty=2, lwd = 2)
lines(x, news[, 3], col="blue", lty=2, lwd = 2)
x <- seq(0, 2, length.out = 100)
y <- 2.5*x + 3 + rnorm(100, 0, 1)
plot(x, y)
fit <- lm(y~x)
summary(fit)
abline(fit, col="red", lwd = 2)
means <- predict(fit, interval = "c")
lines(x, means[, 2], col="purple", lty=2, lwd = 2)
lines(x, means[, 3], col="purple", lty=2, lwd = 2)
news <- predict(fit, interval = "p")
lines(x, news[, 2], col="blue", lty=2, lwd = 2)
lines(x, news[, 3], col="blue", lty=2, lwd = 2)
dat <- read.table("dati/Insulate.dat", col.names=c("when","temp","cons"))
dat <- read.table("dati/Insulate.dat", col.names=c("when","temp","cons"))
dat <- read.table("Insulate.dat", col.names=c("when","temp","cons"))
dat <- read.table("Insulate.dat", col.names=c("when","temp","cons"))
y <- dat$cons
x <- dat$temp
n <- nrow(dat)
par(mar=c(4,6,1,1))
plot(x,y, pch=20, col=4, xlab="average external temperature", ylab="gas consumption of a house ", main="", cex.lab=0.6, cex.axis=.4)
fit <- lm(y~x)
summary(fit)
b1hat <- cov(x,y)/var(x)
b0hat <- mean(y) - b1hat*mean(x)
abline(b0hat,b1hat)
b1hat <- cov(x,y)/var(x)
b0hat <- mean(y) - b1hat*mean(x)
plot(x,y, pch=20, col=4, xlab="average external temperature", ylab="gas consumption of a house ", main="", cex.lab=0.6, cex.axis=.4)
abline(b0hat,b1hat)
yhat <- predict(fit)
e <- y-yhat
summary(e)
shat <- sqrt(sum(e^2)/(n-2))
ESS <- sum(e^2)
TSS <- sum((y-mean(y))^2)
TSS-ESS # RSS
(TSS - ESS)/TSS # R2
((TSS - ESS)/(2-1))/(ESS/(n-2)) # F(1,54)
pf(((TSS - ESS)/(2-1))/(ESS/(n-2)), df1 = 1, 54, lower.tail = F)
seb0hat <- sqrt((shat^2*sum(x^2))/(n*sum((x-mean(x))^2))) #se(b0hat)
seb1hat <- sqrt(shat^2/sum((x-mean(x))^2)) #se(b1hat)
b1hat/seb1hat # t value
2*pt(abs(b1hat/seb1hat), n-2, lower.tail = F)
((TSS - ESS)/(2-1))/(ESS/(n-2))
(b1hat/seb1hat)^2
lam = 0.5
Y = rpois(1000, lam)
c("mean"=mean(Y), "sd"=sd(Y))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mu/n, "sd"=sqrt(s2/(n^2)), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=lam/sqrt(n))
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sd(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sd(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
hist(mu)
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
hist(mu)
abline(v=c(-1)*sqrt(lam/n))
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
hist(mu)
abline(v=c(-1, 1)*sqrt(lam/n))
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
hist(mu)
abline(v=c(-1, 1)*sqrt(lam/n))
abline(v=c(-1, 1)*sd(mu))
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
hist(mu)
abline(v=c(-1, 1)*sqrt(lam/n))
abline(v=c(-1, 1)*sd(mu), lwd=2, c="red")
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam)
lam = 1
Y = rpois(1000, lam)
c("mean"=mean(Y), "sd"=sd(Y))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam)
lam = 1
Y = rpois(1000, lam)
c("mean"=mean(Y), "sd"=sd(Y))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
n  <- 10000
mu <- rep(0, n)
for (i in 1:n){
mu[i] <- mean(rpois(1000, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/1000))
n  <- 1000
R  <- 10000
mu <- rep(0, R)
for (i in 1:R){
mu[i] <- mean(rpois(n, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
lam = 0.5
Y = rpois(1000, lam)
c("mean"=mean(Y), "sd"=sd(Y))
n  <- 1000
R  <- 10000
mu <- rep(0, R)
for (i in 1:R){
mu[i] <- mean(rpois(n, lam))
}
c("mean"=mean(mu), "sd"=sd(mu), "theoretical mean"=lam, "theoretical sd"=sqrt(lam/n))
setwd("C:/Users/stefa/Downloads/Università/Materie/Magistrale/Anno 1/Semestre 1/Statistical Methods/Homework3")
UN <- read.table("UN.txt", header=T)
UN
model <- lm(Internet ~ ., data=UN)
summary(model)
model <- lm(Internet ~ , data=UN)
summary(model)
is.na(UN)
which(is.na(UN))
is.na(UN)
UN
model <- lm(Internet ~ Homicide, data=UN)
summary(model)
?lm
model <- lm(Internet ~., data=UN)
summary(model)
model2 <- lm(Internet ~ GDP, data=UN)
summary(model)
summary(model2)
?vif
library(car)
dataset <- read.table("UN.txt", header=T)
model <- lm( ~., data=dataset)
summary(model)
model2 <- lm(Internet ~ GDP, data=dataset)
summary(model2)
library(car)
vif(model)
vif(model2)
vif(model)
crab2 <- read.table("Crab2.txt", header = T)
crab2 <- read.table("Crabs2.txt", header = T)
crabs2
crab2
?anova
Anova(lm(SpermTotal ~ CW + factor(Color) + CW:factor(Color), data=Crabs2))
Anova(lm(SpermTotal ~ CW + factor(Color) + CW:factor(Color), data=crab2))
